#!/usr/bin/env bash

mkdir -p .

if ! command -v gdalinfo &> /dev/null
then
  echo "Error: gdalinfo could not be found. Please install GDAL."
  exit 1
fi
if ! command -v gdalbuildvrt &> /dev/null
then
  echo "Error: gdalbuildvrt could not be found. Please install GDAL."
  exit 1
fi
if ! command -v gdal_translate &> /dev/null
then
  echo "Error: gdal_translate could not be found. Please install GDAL."
  exit 1
fi
if ! command -v gdalwarp &> /dev/null
then
  echo "Error: gdalwarp could not be found. Please install GDAL."
  exit 1
fi
if ! command -v jq &> /dev/null
then
  echo "Error: jq could not be found. Please install jq: https://jqlang.github.io/jq/."
  exit 1
fi

if ! [ -f ./c21d3a8cff2ff76f.jpg ]; then
  echo "Image file does not exist: ./c21d3a8cff2ff76f.jpg"
  echo "This script expects a full-size source images for each georeferenced map it processes. See the README for more information."
  exit 1
fi

required_width_c21d3a8cff2ff76f_c969e4bba21381cf=5207
required_height_c21d3a8cff2ff76f_c969e4bba21381cf=7446

width_c21d3a8cff2ff76f_c969e4bba21381cf=( $(gdalinfo -json ./c21d3a8cff2ff76f.jpg | jq '.size[0]') )
height_c21d3a8cff2ff76f_c969e4bba21381cf=( $(gdalinfo -json ./c21d3a8cff2ff76f.jpg | jq '.size[1]') )

if [ "$width_c21d3a8cff2ff76f_c969e4bba21381cf" -eq "$required_width_c21d3a8cff2ff76f_c969e4bba21381cf" ] &&
   [ "$height_c21d3a8cff2ff76f_c969e4bba21381cf" -eq "$required_height_c21d3a8cff2ff76f_c969e4bba21381cf" ]; then
    echo "Found image with correct size: ./c21d3a8cff2ff76f.jpg"
else
    echo "Error: found image with incorrect size"
    echo "  Image: ./c21d3a8cff2ff76f.jpg"
    echo "  Expected: $required_width_c21d3a8cff2ff76f_c969e4bba21381cf x $required_height_c21d3a8cff2ff76f_c969e4bba21381cf"
    echo "  Found: $width_c21d3a8cff2ff76f_c969e4bba21381cf x $height_c21d3a8cff2ff76f_c969e4bba21381cf"
    exit 1
fi
gdal_translate -of vrt \
  -a_srs 'PROJCS["ETRS89 / EPSG Arctic zone 3-11",GEOGCS["ETRS89",DATUM["European_Terrestrial_Reference_System_1989",SPHEROID["GRS 1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6258"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4258"]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["latitude_of_origin",78.7073375277778],PARAMETER["central_meridian",21],PARAMETER["standard_parallel_1",80.3333333333333],PARAMETER["standard_parallel_2",77],PARAMETER["false_easting",11500000],PARAMETER["false_northing",3500000],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","6070"]]' \
  -gcp 3103 3990 11524718.35260608 3449968.8974649766 \
-gcp 1529 2742 11302166.506173985 3631021.8684880296 \
-gcp 3153 2208 11533022.189509563 3700359.070129308 \
-gcp 2501 2918 11444540.361879302 3602852.000920345 \
-gcp 2499 2700 11443319.228729798 3634024.555050764 \
-gcp 1835 4448 11350516.94428566 3390230.9201075416 \
-gcp 2335 2650 11422509.640410041 3642020.0975156166 \
-gcp 2861 4050 11491479.27287441 3443136.6247577425 \
-gcp 1829 4082 11343111.412228195 3441845.757555376 \
-gcp 2921 4638 11496808.062443377 3358667.7553658895 \
-gcp 1465 3974 11298685.087111631 3459020.1544550136 \
-gcp 3761 3514 11619135.79416805 3518925.2211233648 \
-gcp 2779 3834 11481636.603534888 3474589.3198410617 \
-gcp 2873 3136 11494686.485767378 3573034.8483766774 \
-gcp 1703 2696 11327374.7518519 3639711.722254046 \
-gcp 4219 3382 11683796.835594252 3537138.0183097282 \
-gcp 2551 4184 11448501.064757213 3425147.705987286 \
-gcp 2031 3826 11376232.342790423 3477643.627908517 \
-gcp 1459 3784 11297427.35424765 3486582.151231213 \
-gcp 2633 2364 11463164.334784597 3683015.3998130006 \
-gcp 2449 4588 11432853.746015944 3366646.6458589975 \
-gcp 1997 2772 11372317.377889907 3628996.6961905966 \
-gcp 2249 2572 11408069.014365768 3654416.4315750385 \
-gcp 1343 3364 11274568.95310599 3541268.9498656234 \
-gcp 1935 3888 11360090.205975981 3470987.8554100394 \
-gcp 3231 3998 11541319.989087421 3450132.293870921 \
-gcp 1973 3722 11366656.328778183 3493554.555669045 \
-gcp 1473 3362 11294484.086547645 3545797.205662829 \
-gcp 2713 2918 11473562.384534918 3600513.2761356905 \
-gcp 2789 2220 11481734.3012457 3703546.9122582646 \
-gcp 1571 3180 11309304.361279145 3571136.9277961436 \
-gcp 3169 4746 11537703.886338871 3342230.6573640136 \
-gcp 4313 3298 11699050.124849942 3549836.7741366522 \
-gcp 1865 2894 11348906.300649827 3609731.6478126706 \
-gcp 1691 4366 11328249.905425033 3402424.2044416415 \
-gcp 1895 2708 11358017.759128153 3639833.0952444314 \
-gcp 2995 3690 11507597.699503409 3495856.1166641917 \
-gcp 1651 2690 11319802.530620325 3640996.180070423 \
-gcp 2077 5320 11379618.21201406 3264989.2466801694 \
-gcp 2205 3474 11401744.655147124 3525081.585597641 \
-gcp 2121 5392 11384384.129324703 3254287.5287686028 \
-gcp 3285 4774 11550040.980548581 3339529.6256294893 \
  ./c21d3a8cff2ff76f.jpg \
  ./c21d3a8cff2ff76f_c969e4bba21381cf.vrt

echo '{"type":"Polygon","coordinates":[[[11.330381699435918,76.1838216494745],[11.593773232173701,76.19286635685374],[11.857501187737894,76.20162726584057],[12.121555444286757,76.21010383620151],[12.385925801603197,76.21829554397134],[12.650601983263922,76.2262018816073],[12.915573638852914,76.23382235813894],[13.180830346219182,76.24115649931376],[13.446361613777475,76.24820384773837],[13.712156882849172,76.25496396301511],[13.978205530044804,76.26143642187417],[14.244496869684797,76.26762081830076],[14.511020156258372,76.27351676365781],[14.777764586918453,76.27912388680345],[15.04471930401148,76.28444183420382],[15.311873397641522,76.2894702700406],[15.579215908265516,76.29420887631359],[15.846735829319881,76.29865735293797],[16.114422109875793,76.30281541783634],[16.382263657322692,76.30668280702555],[16.6502493400764,76.31025927469786],[16.91836799031287,76.31354459329688],[17.186608406724226,76.31653855358799],[17.454959357295287,76.31924096472308],[17.723409582099976,76.32165165429977],[17.991947796115273,76.32377046841492],[18.260562692050648,76.32559727171264],[18.529242943191626,76.32713194742624],[18.797977206255876,76.32837439741475],[19.066754124259845,76.32932454219348],[19.335562329393436,76.32998232095883],[19.60439044590254,76.33034769160734],[19.873227092975497,76.33042063074876],[20.14206088763395,76.33020113371339],[20.41088044762392,76.32968921455351],[20.67967439430716,76.3288849060391],[20.948431355550483,76.32778825964742],[21.217139968609665,76.32639934554715],[21.485788883008716,76.32471825257623],[21.754366763411046,76.3227450882144],[22.02286229248042,76.32047997854949],[22.291264173731225,76.31792306823823],[22.559561134365435,76.31507452046127],[22.827741928094397,76.31193451687233],[23.095795337943862,76.30850325754197],[23.363710179040897,76.30478096089546],[23.6314753013807,76.30076786364523],[23.89907959257089,76.29646422071772],[24.16651198055333,76.2918703051748],[24.433761436299708,76.28698640812966],[24.70081697648146,76.28181283865754],[24.967667666110355,76.27634992370092],[25.2343026211499,76.27059800796965],[25.500711011095298,76.26455745383586],[25.766882061520256,76.25822864122377],[26.032805056589535,76.25161196749455],[26.298469341536084,76.24470784732623],[26.56386432510117,76.23751671258864],[26.828979481935495,76.23003901221395],[27.093804354961613,76.22227521206206],[27.3583285576948,76.21422579478183],[27.622541776521935,76.2058912596676],[27.88643377293754,76.19727212251152],[28.149994385735177,76.18836891545139],[28.41321353315385,76.17918218681447],[28.448564865034264,76.23862884613023],[28.484219780910696,76.2980725056303],[28.520182181344058,76.35751304586395],[28.55645603353038,76.4169503460582],[28.59304537271994,76.47638428409165],[28.62995430367145,76.5358147364675],[28.667187002144406,76.59524157828585],[28.70474771642913,76.65466468321542],[28.742640768916168,76.71408392346456],[28.78087055770674,76.77349916975135],[28.819441558264906,76.8329102912731],[28.858358325112597,76.89231715567503],[28.89762549356903,76.95171962901814],[28.93724778153616,77.0111175757462],[28.977229991331306,77.07051085865194],[29.01757701156797,77.12989933884228],[29.058293819087208,77.18928287570279],[29.099385480939855,77.24866132686105],[29.140857156423426,77.30803454814917],[29.182714099172465,77.36740239356514],[29.224961659306416,77.42676471523345],[29.267605285634975,77.48612136336428],[29.310650527925237,77.54547218621185],[29.35410303922939,77.6048170300316],[29.397968578277546,77.66415573903606],[29.442253011936117,77.72348815534974],[29.486962317734978,77.78281411896258],[29.532102586465168,77.84213346768223],[29.577680024849,77.90144603708495],[29.623700958285358,77.96075166046518],[29.670171833672942,78.02005016878365],[29.717099222313628,78.07934139061412],[29.764489822898362,78.13862515208848],[29.81235046457844,78.19790127684044],[29.86068811012601,78.25716958594748],[29.909509859184674,78.31642989787119],[29.958822951615765,78.3756820283944],[30.008634770940848,78.43492579056426],[30.058952847886456,78.49416099461777],[30.109784864031777,78.55338744792125],[30.16113865556502,78.61260495489991],[30.213022217151263,78.67181331696695],[30.265443705915178,78.7310123324505],[30.31841144554352,78.79020179651862],[30.371933930510714,78.84938150110169],[30.426019830432573,78.90855123481278],[30.480677994552337,78.96771078286545],[30.53591745636328,79.02685992698905],[30.591747438372607,79.08599844534147],[30.648177357013708,79.14512611241932],[30.705216827708675,79.20424269896499],[30.76287567008911,79.26334797187128],[30.82116391338005,79.32244169408266],[30.880091801951977,79.38152362449372],[30.93966980104968,79.44059351784418],[30.999908602700987,79.49965112461076],[31.060819131814114,79.55869619089556],[31.122412552470344,79.61772845831074],[31.184700274418987,79.67674766385966],[31.247693959781706,79.73575353981404],[31.31140552997481,79.79474581358724],[31.37584717285688,79.85372420760332],[31.441031350111103,79.91268843916174],[31.50697080487084,79.9716382202977],[31.531938512599172,79.97080627592412],[31.556902134058163,79.9699724730559],[31.58186166113885,79.96913681214765],[31.606817085740524,79.96829929365497],[31.63176839977179,79.96745991803417],[31.656715595149365,79.96661868574252],[31.681658663798718,79.96577559723815],[31.7065975976542,79.96493065298003],[31.73153238865877,79.96408385342798],[31.75646302876419,79.9632351990427],[31.781389509930676,79.96238469028573],[31.80631182412744,79.96153232761948],[31.831229963332476,79.9606781115072],[31.856143919532236,79.95982204241304],[31.881053684722232,79.95896412080192],[31.905959250906676,79.9581043471397],[31.93086061009867,79.957242721893],[31.95575775431985,79.95637924552939],[31.98065067560095,79.9555139185172],[32.00553936598153,79.95464674132566],[32.03042381750975,79.95377771442483],[32.055304022242964,79.9529068382856],[32.08017997224697,79.95203411337974],[32.10505165959705,79.9511595401798],[32.129919076376794,79.95028311915924],[32.15478221467911,79.94940485079232],[32.179641066605484,79.94852473555414],[32.2044956242666,79.94764277392068],[32.22934587978207,79.94675896636866],[32.25419182528022,79.94587331337573],[32.27903345289859,79.94498581542037],[32.30387075478361,79.94409647298178],[32.3287037230908,79.94320528654015],[32.35353234998437,79.94231225657639],[32.378356627637864,79.94141738357226],[32.40317654823383,79.94052066801035],[32.42799210396356,79.93962211037415],[32.452803287027685,79.93872171114785],[32.47761008963579,79.93781947081652],[32.502412504006635,79.93691538986609],[32.52721052236786,79.93600946878327],[32.5520041369561,79.93510170805558],[32.576793340017666,79.9341921081714],[32.6015781238073,79.93328066961988],[32.626358480589275,79.93236739289102],[32.65113440263688,79.93145227847565],[32.67590588223265,79.93053532686535],[32.700672911668086,79.92961653855258],[32.72543548324378,79.92869591403058],[32.750193589270026,79.9277734537934],[32.7749472220657,79.92684915833593],[32.799696373959286,79.9259230281538],[32.824441037288054,79.92499506374351],[32.84918120439914,79.92406526560234],[32.87391686764834,79.9231336342284],[32.89864801940079,79.92220017012055],[32.92337465203105,79.9212648737785],[32.94809675792288,79.92032774570272],[32.97281432946938,79.91938878639453],[32.997527359072656,79.91844799635602],[33.02223583914438,79.91750537609006],[33.04693976210555,79.91656092610035],[33.07163912038619,79.91561464689136],[33.096333906425905,79.91466653896835],[33.10452990333434,79.92175015120438],[33.112737262306304,79.92883353921484],[33.12095600666037,79.93591670246255],[33.129186159778016,79.94299964040918],[33.137427745103885,79.95008235251512],[33.14568078614599,79.95716483823959],[33.15394530647579,79.96424709704054],[33.16222132972883,79.97132912837469],[33.17050887960446,79.97841093169752],[33.17880797986603,79.9854925064633],[33.1871186543415,79.99257385212503],[33.19544092692369,79.99965496813442],[33.20377482156994,80.00673585394202],[33.21212036230278,80.013816508997],[33.220477573210026,80.02089693274736],[33.22884647844498,80.02797712463983],[33.23722710222669,80.03505708411981],[33.245619468840054,80.04213681063148],[33.25402360263648,80.04921630361768],[33.26243952803324,80.05629556252005],[33.27086726951446,80.06337458677886],[33.279306851631326,80.07045337583315],[33.28775829900177,80.07753192912062],[33.296221636311216,80.08461024607767],[33.3046968883122,80.09168832613945],[33.31318407982558,80.09876616873971],[33.3216832357398,80.10584377331098],[33.33019438101149,80.1129211392844],[33.33871754066608,80.11999826608981],[33.34725273979711,80.12707515315573],[33.35580000356737,80.13415179990936],[33.36435935720858,80.14122820577654],[33.37293082602209,80.14830437018176],[33.381514435378676,80.1553802925482],[33.390110210718646,80.16245597229768],[33.398718177552915,80.16953140885064],[33.407338361462344,80.17660660162618],[33.41597078809842,80.18368155004205],[33.42461548318338,80.1907562535146],[33.433272472510524,80.19783071145885],[33.441941781944365,80.20490492328842],[33.45062343742095,80.21197888841552],[33.459317464947944,80.21905260625103],[33.468023890605416,80.22612607620437],[33.47674274054507,80.23319929768365],[33.48547404099138,80.24027227009552],[33.49421781824174,80.24734499284523],[33.50297409866622,80.25441746533663],[33.511742908708335,80.26148968697217],[33.520524274884664,80.26856165715286],[33.529318223786085,80.27563337527828],[33.5381247820771,80.2827048407466],[33.546943976496394,80.28977605295455],[33.555775833857446,80.29684701129743],[33.56462038104831,80.30391771516908],[33.5734776450318,80.31098816396188],[33.58234765284622,80.31805835706682],[33.59123043160552,80.32512829387333],[33.60012600849918,80.33219797376947],[33.6090344107928,80.33926739614179],[33.61795566582826,80.34633656037538],[33.62688980102401,80.35340546585384],[33.63583684387528,80.36047411195928],[33.644796821954365,80.36754249807234],[33.61928899737914,80.36837706308714],[33.593776822789145,80.36920976379463],[33.56826030680273,80.37004059972112],[33.54273945804739,80.37086957039386],[33.51721428516057,80.37169667534096],[33.49168479678886,80.37252191409146],[33.46615100158871,80.37334528617531],[33.44061290822574,80.37416679112334],[33.41507052537541,80.37498642846732],[33.38952386172229,80.37580419773994],[33.363972925960766,80.37662009847473],[33.3384177267943,80.37743413020621],[33.31285827293608,80.37824629246977],[33.28729457310859,80.37905658480175],[33.26172663604383,80.37986500673934],[33.236154470482894,80.38067155782072],[33.21057808517663,80.38147623758496],[33.18499748888487,80.38227904557203],[33.15941269037713,80.38307998132287],[33.133823698431925,80.38387904437928],[33.108230521837434,80.38467623428403],[33.08263316939077,80.38547155058079],[33.0570316498987,80.38626499281418],[33.03142597217686,80.38705656052971],[33.00581614505056,80.38784625327385],[32.98020217735384,80.38863407059401],[32.95458407793064,80.38942001203849],[32.928961855633446,80.39020407715654],[32.9033355193244,80.39098626549834],[32.87770507787446,80.39176657661504],[32.85207054016412,80.39254501005868],[32.82643191508262,80.39332156538225],[32.800789211528745,80.39409624213967],[32.775142438409986,80.39486903988583],[32.74949160464333,80.39563995817655],[32.723836719154455,80.39640899656854],[32.69817779087854,80.39717615461953],[32.67251482875936,80.39794143188814],[32.646847841750066,80.39870482793398],[32.621176838812715,80.39946634231757],[32.59550182891849,80.40022597460039],[32.56982282104725,80.40098372434485],[32.544139824188115,80.40173959111436],[32.5184528473392,80.40249357447324],[32.49276189950733,80.40324567398675],[32.46706698970828,80.40399588922115],[32.44136812696693,80.40474421974363],[32.415665320317046,80.40549066512234],[32.389958578800986,80.40623522492638],[32.36424791147034,80.40697789872578],[32.33853332738521,80.40771868609164],[32.312814835614844,80.40845758659589],[32.28709244523687,80.40919459981149],[32.261366165338394,80.40992972531234],[32.23563600501458,80.41066296267331],[32.20990197336988,80.41139431147027],[32.184164079517096,80.41212377128001],[32.158422332578155,80.41285134168028],[32.132676741683284,80.41357702224985],[32.106927315971845,80.41430081256846],[32.081174064591444,80.41502271221674],[32.05541699669876,80.4157427207764],[32.029656121458736,80.41646083783002],[32.00389144804533,80.41717706296123],[32.009614897547635,80.42210701603878],[32.01534415374676,80.42703686049312],[32.021079225373775,80.43196659614017],[32.02682012117674,80.43689622279551],[32.03256684992115,80.44182574027444],[32.038319420389854,80.44675514839194],[32.044077841383,80.4516844469627],[32.04984212171852,80.45661363580106],[32.055612270231535,80.46154271472112],[32.06138829577479,80.46647168353658],[32.067170207218645,80.47140054206093],[32.07295801345104,80.47632929010729],[32.07875172337764,80.48125792748847],[32.08455134592178,80.48618645401699],[32.09035689002445,80.49111486950504],[32.09616836464479,80.4960431737645],[32.10198577875943,80.50097136660698],[32.107809141362985,80.50589944784366],[32.113638461468064,80.51082741728555],[32.11947374810518,80.51575527474323],[32.12531501032289,80.520683020027],[32.13116225718785,80.52561065294687],[32.13701549778478,80.53053817331251],[32.14287474121646,80.53546558093328],[32.148739996604185,80.54039287561815],[32.15461127308716,80.54532005717589],[32.160488579823024,80.55024712541486],[32.166371925987626,80.55517408014313],[32.17226132077548,80.56010092116843],[32.17815677339925,80.5650276482982],[32.184058293090125,80.56995426133949],[32.18996588909787,80.57488076009909],[32.19587957069076,80.57980714438344],[32.201799347155685,80.58473341399866],[32.207725227798214,80.58965956875052],[32.21365722194259,80.59458560844446],[32.21959533893181,80.59951153288563],[32.22553958812765,80.60443734187882],[32.23148997891074,80.60936303522847],[32.237446520680585,80.61428861273873],[32.243409222855526,80.61921407421342],[32.24937809487308,80.62413941945596],[32.25535314618978,80.62906464826949],[32.261334386281064,80.63398976045683],[32.26732182464154,80.63891475582041],[32.273315470785036,80.64383963416236],[32.27931533424456,80.64876439528447],[32.28532142457238,80.65368903898819],[32.29133375134012,80.65861356507459],[32.297352324138714,80.66353797334448],[32.30337715257851,80.66846226359823],[32.30940824628936,80.67338643563598],[32.31544561492055,80.67831048925743],[32.321489268140866,80.68323442426198],[32.32753921563899,80.6881582404487],[32.333595467122954,80.69308193761628],[32.33965803232058,80.69800551556307],[32.34572692097944,80.7029289740871],[32.35180214286681,80.70785231298603],[32.35788370777013,80.71277553205715],[32.36397162549641,80.71769863109746],[32.37006590587273,80.72262160990357],[32.37616655874614,80.72754446827172],[32.382273593983776,80.73246720599785],[31.996596108854064,80.74606858623811],[31.609817483298038,80.75925918359131],[31.22196703680661,80.77203727534047],[30.833074629379695,80.78440118349606],[30.44317065090701,80.79634927583132],[30.052286009915978,80.80787996689882],[29.660452121690433,80.81899171902674],[29.267700895768833,80.82968304329354],[28.87406472282832,80.83995250047971],[28.47957646096665,80.84979870199494],[28.084269421389376,80.85922031077983],[27.688177353517947,80.86821604218046],[27.291334429530753,80.87678466479457],[26.893775228351334,80.88492500128831],[26.495534719101173,80.89263592918196],[26.096648244034622,80.89991638160392],[25.697151500973625,80.90676534801113],[25.297080525262313,80.91318187487555],[24.89647167126374,80.91916506633497],[24.495361593420448,80.92471408480775],[24.093787226900574,80.92982815156972],[23.69178576785749,80.93450654729332],[23.289394653324614,80.93874861254706],[22.886651540774533,80.94255374825542],[22.483594287367485,80.9459214161177],[22.0802609289187,80.94885113898576],[21.676689658613395,80.95134250119948],[21.272918805497795,80.95339514887984],[20.868986812776278,80.9550087901788],[20.46493221594637,80.95618319548576],[20.060793620801924,80.95691819759037],[19.656609681334118,80.95721369180086],[19.25241907756546,80.95706963601849],[18.84826049334478,80.9564860507674],[18.444172594137882,80.95546301918004],[18.04019400484339,80.95400068693816],[17.63636328766796,80.95209926216947],[17.23271892009017,80.94975901530016],[16.829299272947267,80.94698027886352],[16.42614258867215,80.94376344726486],[16.023286959714827,80.94010897650332],[15.620770307176972,80.93601738385104],[15.218630359687914,80.93148924748968],[14.816904632554394,80.92652520610596],[14.415630407208777,80.9211259584456],[14.01484471098595,80.91529226282748],[13.614584297253243,80.90902493661808],[13.21488562592142,80.90232485566747],[12.815784844359234,80.89519295370752],[12.417317768737982,80.8876302217134],[12.019519865825142,80.87963770722924],[11.62242623525191,80.87121651365936],[11.226071592273694,80.86236779952557],[10.830490251041748,80.85309277769245],[10.435716108405405,80.84339271456093],[10.041782628261238,80.83326892923232],[9.648722826463844,80.82272279264319],[9.256569256312092,80.81175572667301],[8.865353994624796,80.80036920322554],[8.47510862841667,80.78856474328538],[8.085864242182781,80.77634391595105],[7.697651405803886,80.76370833744599],[7.310500163076113,80.75065967010892],[6.924440020873926,80.73719962136467],[11.330381699435918,76.1838216494745]]]}' > ./c21d3a8cff2ff76f_c969e4bba21381cf.geojson

gdalwarp \
  -of COG -co COMPRESS=JPEG -co QUALITY=75 \
  -dstalpha -overwrite \
  -r cubic \
  -cutline ./c21d3a8cff2ff76f_c969e4bba21381cf.geojson -crop_to_cutline -cutline_srs "EPSG:4326" \
  -s_srs 'PROJCS["ETRS89 / EPSG Arctic zone 3-11",GEOGCS["ETRS89",DATUM["European_Terrestrial_Reference_System_1989",SPHEROID["GRS 1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6258"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4258"]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["latitude_of_origin",78.7073375277778],PARAMETER["central_meridian",21],PARAMETER["standard_parallel_1",80.3333333333333],PARAMETER["standard_parallel_2",77],PARAMETER["false_easting",11500000],PARAMETER["false_northing",3500000],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","6070"]]' \
  -t_srs 'EPSG:3857' \
  -ts 4103 3544 \
  -order 1 \
  ./c21d3a8cff2ff76f_c969e4bba21381cf.vrt \
  ./c21d3a8cff2ff76f_c969e4bba21381cf-warped.tif

gdalbuildvrt ./c21d3a8cff2ff76f_c969e4bba21381cf.vrt \
  ./c21d3a8cff2ff76f_c969e4bba21381cf-warped.tif
