# @allmaps/annotation

@allmaps/annotation is a JavaScript module that can generate and parse *georeference annotations*.

A georeference annotation is a [Web Annotation](https://www.w3.org/TR/annotation-model/) that stores the metadata needed to [georeference](https://en.wikipedia.org/wiki/Georeferencing) a [IIIF image](https://iiif.io/api/image/3.0/). The [IIIF community](https://iiif.io/community/groups/maps-tsg/) is working on a turning georeference annotations into a specification and a [IIIF extension](https://iiif.io/api/index.html#approved-extensions).

A georeference annotation contains the following data:

*   The [URI of an IIIF Image](https://iiif.io/api/image/3.0/#3-identifier), as well as its dimensions in pixels.
*   A list of ground control points (GCPs) that define the mapping between pixels and geospatial coordinates.
*   A polygonal pixel mask that defines the cartographic part of the image.

Georeference annotation are a core part of Allmaps.

**[Allmaps Viewer]() can warp maps , only annotation and iiif image**

<!-- TODO: create Observable notebook that allows you to try out this module! -->

## Installation & usage

This is an ESM-only module that works in browsers or in Node.js.

Node.js:

First, run `npm install @allmaps/annotation` to add this module to your project.

```js
import { parseAnnotation, generateAnnotation } from '@allmaps/annotation'
```

Browser:

```html
<script type="module">
  import { parseAnnotation, generateAnnotation } from 'https://unpkg.com/@allmaps/annotation?module'
</script>
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

*   [Generating & parsing georeference annotations](#generating--parsing-georeference-annotations)
    *   [parseAnnotation](#parseannotation)
        *   [Parameters](#parameters)
        *   [Examples](#examples)
    *   [generateAnnotation](#generateannotation)
        *   [Parameters](#parameters-1)
        *   [Examples](#examples-1)
*   [Types](#types)
    *   [Map](#map)
    *   [Annotation](#annotation)

### Generating & parsing georeference annotations



#### parseAnnotation

Parses a [georeference annotation](#annotation) and returns an array of [maps](#map).

##### Parameters

*   `annotation` **[Annotation](#annotation)** Georeference annotation

##### Examples

```javascript
import fs from 'fs'
import { parseAnnotation } from '@allmaps/annotation'

const annotation = JSON.parse(fs.readFileSync('./examples/annotation.example.json'))
const maps = parseAnnotation(annotation)
```

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Map](#map)>** Array of maps

#### generateAnnotation

Generates a [georeference annotation](#annotation) from a single [map](#map) or an array of [maps](#map).

##### Parameters

*   `mapOrMaps` **([Map](#map) | [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Map](#map)>)** Single map object, or array of maps

##### Examples

```javascript
import fs from 'fs'
import { generateAnnotation } from '@allmaps/annotation'

const map = JSON.parse(fs.readFileSync('./examples/map.example.json'))
const annotation = generateAnnotation(map)
```

Returns **[Annotation](#annotation)** Georeference annotation

### Types

The two types this module converts between, [Annotation](#annotation) and [Map](#map), are described below.

#### Map

Object that contains the data needed to georeference a IIIF map. For details, see its [JSON Schema](schemas/map.json) or the [example](examples/map.example.json) in the `examples` directory.

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

#### Annotation

[Web Annotation](https://www.w3.org/TR/annotation-model/) that contains a single georeference annotation or an [Annotation Page](https://www.w3.org/TR/annotation-model/#annotation-page) with georeference annotation. For details, see its [JSON Schema](schemas/annotation.json) or the [example](examples/annotation.example.json) in the `examples` directory.

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)
