# @allmaps/annotation

@allmaps/annotation is a JavaScript module that can generate and parse [Georeference Annotations](https://iiif.io/api/extension/georef/).

A Georeference Annotation is a [Web Annotation](https://www.w3.org/TR/annotation-model/) that stores the metadata needed to [georeference](https://en.wikipedia.org/wiki/Georeferencing) a [IIIF image](https://iiif.io/api/image/3.0/).

A Georeference Annotation contains the following data:

*   The [URI of an IIIF Image](https://iiif.io/api/image/3.0/#3-identifier), as well as its dimensions in pixels.
*   A list of ground control points (GCPs) that define the mapping between resource coordinates and geospatial coordinates.
*   A polygonal resource mask that defines the cartographic part of the image.

Georeference Annotations are a core part of [Allmaps](https://allmaps.org). For example, [Allmaps Viewer](https://viewer.allmaps.org/#data=data%3Atext%2Fx-url%2Chttps%3A%2F%2Fraw.githubusercontent.com%2Fallmaps%2Fannotation%2Fdevelop%2Fexamples%2Fannotation.example.json) can warp maps IIIF maps in the browser, just by loading a georeference annotation.

<!-- TODO: create Observable notebook that allows you to try out this module! -->

## Installation & usage

This is an ESM-only module that works in browsers and Node.js.

Node.js:

First, run `npm install @allmaps/annotation` to add this module to your project.

```js
import { parseAnnotation, generateAnnotation } from '@allmaps/annotation'
```

Browser:

```html
<script type="module">
  import {
    parseAnnotation,
    generateAnnotation
  } from 'https://unpkg.com/@allmaps/annotation?module'
</script>
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

*   [Generating & parsing Georeference Annotations](#generating--parsing-georeference-annotations)
    *   [parseAnnotation](#parseannotation)
    *   [generateAnnotation](#generateannotation)
*   [Types](#types)
    *   [Map](#map)
    *   [Annotation](#annotation)
    *   [AnnotationPage](#annotationpage)

### Generating & parsing Georeference Annotations



#### parseAnnotation

Parses a [Georeference Annotation](#annotation) or an [AnnotationPage](#annotationpage)
containing multiple Georeference Annotations and returns an array of [maps](#map).

##### Parameters

*   `annotation` **([Annotation](#annotation) | [AnnotationPage](#annotationpage))** Georeference Annotation or AnnotationPage containing multiple Georeference Annotations

##### Examples

```javascript
import fs from 'fs'
import { parseAnnotation } from '@allmaps/annotation'

const annotation = JSON.parse(fs.readFileSync('./examples/annotation.example.json'))
const maps = parseAnnotation(annotation)
```

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Map](#map)>** Array of maps

#### generateAnnotation

Generates a [Georeference Annotation](#annotation) from a single [map](#map) or
an [AnnotationPage](#annotationpage) containing multiple Georeference Annotations from an array of [maps](#map).

##### Parameters

*   `mapOrMaps` **([Map](#map) | [Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<[Map](#map)>)** Single map object, or array of maps

##### Examples

```javascript
import fs from 'fs'
import { generateAnnotation } from '@allmaps/annotation'

const map = JSON.parse(fs.readFileSync('./examples/map.example.json'))
const annotation = generateAnnotation(map)
```

Returns **([Annotation](#annotation) | [AnnotationPage](#annotationpage))** Georeference Annotation

### Types

The two types this module converts between, [Annotation](#annotation), [AnnotationPage](#annotationpage) and [Map](#map), are described below.

#### Map

Object that contains the data needed to georeference a IIIF resource in the format that is used by Allmaps internally.

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

#### Annotation

[Web Annotation](https://www.w3.org/TR/annotation-model/) that contains a single [Georeference Annotation](https://iiif.io/api/extension/georef/).

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

#### AnnotationPage

An [Annotation Page](https://www.w3.org/TR/annotation-model/#annotation-page) that contains multiple [Georeference Annotations](https://iiif.io/api/extension/georef/).

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)
