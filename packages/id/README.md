# @allmaps/id

Uses the [SHA-1](https://en.wikipedia.org/wiki/SHA-1) algorithm to generate IDs from strings, random IDs from UUIDs and checksums from JSON objects.

Allmaps uses this module to create IDs from IIIF URIs. For example:

*   Given the following manifest URL: https://polona.pl/iiif/item/NTU5NTE4OTg/manifest.json,
*   The output of the [`generateId`](#generateid) function will be: `4ac2770ae8624e38`,
*   We can use this ID to view the annotation for the georeferenced maps in the manifest in Allmaps:
    https://dev.annotations.allmaps.org/manifests/4ac2770ae8624e38.

## Usage

This is an ESM-only module that works in browsers or in Node.js.

Node.js:

The Node.js version of @allmaps/id uses[`crypto.createHash()`](https://nodejs.org/api/crypto.html#cryptocreatehashalgorithm-options) and [`crypto.randomUUID()`](https://nodejs.org/api/crypto.html#cryptorandomuuidoptions) from the [`crypto` module](https://nodejs.org/api/crypto.html). First, run `npm install @allmaps/id`.

```js
import { generateId } from '@allmaps/id'
const url =
  'https://orka.bibliothek.uni-kassel.de/viewer/rest/iiif/manifests/1535113582549/manifest/'
const id = await generateId(url)
console.log(id)
```

Browser:

The browser version of @allmaps/id uses the [`SubtleCrypto.digest()`](https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest) and [`Crypto.randomUUID()`](https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID) Web APIs.

```html
<script type="module">
  import { generateId } from 'https://unpkg.com/@allmaps/id?module'

  const url =
    'https://orka.bibliothek.uni-kassel.de/viewer/rest/iiif/manifests/1535113582549/manifest/'
  const id = await generateId(url)
  console.log(id)
</script>
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

*   [generateId](#generateid)
    *   [Parameters](#parameters)
*   [generateRandomId](#generaterandomid)
    *   [Parameters](#parameters-1)
*   [generateChecksum](#generatechecksum)
    *   [Parameters](#parameters-2)

### generateId

Generates an ID from a string using the SHA-1 algorithm. Given the same input, the ID will always be the same.

#### Parameters

*   `str` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Input string.
*   `length` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Length of returned hash.  The maximum length of the hash is 40 characters. (optional, default `16`)

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** First `length` characters of the SHA-1 hash of `str`.

### generateRandomId

Generates a random ID.

#### Parameters

*   `length` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Length of returned hash. The maximum length of the hash is 40 characters. (optional, default `16`)

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** First `length` characters of the SHA-1 hash of a random UUID.

### generateChecksum

Generates a checksum of a JSON object.

#### Parameters

*   `obj` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** JSON object.
*   `length` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Length of returned hash. The maximum length of the hash is 40 characters. (optional, default `16`)

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** First `length` characters of the SHA-1 hash of sorted and serialized version of `obj`.
