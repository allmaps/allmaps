# @allmaps/render

Allmaps render module. Renders georeferenced [IIIF](https://iiif.io) maps using [Georeference Annotations](https://iiif.io/api/georef/extension/georef/). Currently, only rendering to a WebGL 2 context is implemented. This module is used by:

*   [Allmaps plugin for Leaflet](../leaflet/)
*   [Allmaps plugin for MapLibre](../maplibre/)
*   [Allmaps plugin for OpenLayers](../openlayers/)

## How it works

The render module accomplishes this task with the following classes:

*   A **`WebGL2RenderingContext`** containing the rendering context for the drawing surface of an HTML element.
*   A **`WebGLProgram`** for storing the vertex and fragment shader
*   A **`WarpedMapList`** containing the list of WarpedMaps to draw
*   A list of **`WebGL2WarpedMap`** elements containing the GL information for each warped map
*   A **`TileCache`** for storing the image bitmaps of cached tiles

This package also contains two other important classes:

*   A **`Viewport`** describes which view of the map should be rendered (extent, zoom level, ...)
*   A **`WarpedMap`** describes how a georeferenced map is warped using a specific transformation

The renderer draws in its WebGL2RenderingContext when its `render` function is called and passed a Viewport (e.g. by a JavaScript mapping library). Then, for each WarpedMap in the `WarpedMapList`, the following happens:

*   The ground control points (GPCs) are read from the Georeference Annotation. These GCOs are used to compute a transformation from IIIF resource coordinates to projected geospatial coordinates.
*   The resource mask is read from the Georeference Annotation, and the area within is divided into small triangles.
*   The best tile zoom level is computed for the current viewport, telling us which IIIF tile [`scaleFactor`](https://iiif.io/api/image/3.0/#54-tiles) to use.
*   The Viewport is transformed backwards from projected geospatial coordinates to resource coordinates of the IIIF image. The IIIF tiles covering this viewport on the resource image are fetched and cached in the TileCache.
*   The area inside the resource mask is rendered in the viewport, triangle by triangle, using the cached tiles. The location of the triangles is computed using the forward transformation built from the GPCs.

## Installation

This package works in browsers and in Node.js as an ESM module.

Install with pnpm:

```sh
pnpm install @allmaps/render
```

You can build this package locally by running:

```sh
pnpm run build
```

## Usage

Import the package and its classes:

```js
import { Viewport, WebGL2Renderer } from '@allmaps/render'
```

For a complete example, see the source code of the Allmaps plugins for [Leaflet](../leaflet/),
[MapLibre](../maplibre/) and [OpenLayers](../openlayers/).

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

*   [constructor](#constructor)
    *   [Parameters](#parameters)
*   [computeProjectedGeoRectangle](#computeprojectedgeorectangle)
    *   [Parameters](#parameters-1)
*   [fromWarpedMapList](#fromwarpedmaplist)
    *   [Parameters](#parameters-2)
*   [fromProjectedGeoBbox](#fromprojectedgeobbox)
    *   [Parameters](#parameters-3)
*   [constructor](#constructor-1)
    *   [Parameters](#parameters-4)
*   [getViewportMask](#getviewportmask)
    *   [Parameters](#parameters-5)
*   [getViewportMaskBbox](#getviewportmaskbbox)
    *   [Parameters](#parameters-6)
*   [getViewportMaskRectangle](#getviewportmaskrectangle)
    *   [Parameters](#parameters-7)
*   [getViewportFullMask](#getviewportfullmask)
    *   [Parameters](#parameters-8)
*   [getViewportFullMaskBbox](#getviewportfullmaskbbox)
    *   [Parameters](#parameters-9)
*   [getViewportFullMaskRectangle](#getviewportfullmaskrectangle)
    *   [Parameters](#parameters-10)
*   [getResourceToViewportScale](#getresourcetoviewportscale)
    *   [Parameters](#parameters-11)
*   [getResourceToCanvasScale](#getresourcetocanvasscale)
    *   [Parameters](#parameters-12)
*   [getReferenceScale](#getreferencescale)
*   [setResourceViewportRing](#setresourceviewportring)
    *   [Parameters](#parameters-13)
*   [setResourceMask](#setresourcemask)
    *   [Parameters](#parameters-14)
*   [setTransformationType](#settransformationtype)
    *   [Parameters](#parameters-15)
*   [setDistortionMeasure](#setdistortionmeasure)
    *   [Parameters](#parameters-16)
*   [setGcps](#setgcps)
    *   [Parameters](#parameters-17)
*   [setBestScaleFactor](#setbestscalefactor)
    *   [Parameters](#parameters-18)
*   [hasImageInfo](#hasimageinfo)
*   [loadImageInfo](#loadimageinfo)
*   [constructor](#constructor-2)
    *   [Parameters](#parameters-19)
*   [setResourceMask](#setresourcemask-1)
    *   [Parameters](#parameters-20)
*   [setBestScaleFactor](#setbestscalefactor-1)
    *   [Parameters](#parameters-21)
*   [updateTriangulation](#updatetriangulation)
    *   [Parameters](#parameters-22)
*   [updateProjectedGeoTrianglePoints](#updateprojectedgeotrianglepoints)
    *   [Parameters](#parameters-23)
*   [updateTrianglePointsDistortion](#updatetrianglepointsdistortion)
    *   [Parameters](#parameters-24)
*   [resetTrianglePoints](#resettrianglepoints)
*   [mixTrianglePoints](#mixtrianglepoints)
    *   [Parameters](#parameters-25)
*   [constructor](#constructor-3)
    *   [Parameters](#parameters-26)
*   [updateVertexBuffers](#updatevertexbuffers)
    *   [Parameters](#parameters-27)
*   [addCachedTileAndUpdateTextures](#addcachedtileandupdatetextures)
    *   [Parameters](#parameters-28)
*   [removeCachedTileAndUpdateTextures](#removecachedtileandupdatetextures)
    *   [Parameters](#parameters-29)
*   [constructor](#constructor-4)
    *   [Parameters](#parameters-30)
*   [getMapIds](#getmapids)
*   [getWarpedMap](#getwarpedmap)
    *   [Parameters](#parameters-31)
*   [getMapZIndex](#getmapzindex)
    *   [Parameters](#parameters-32)
*   [getBbox](#getbbox)
*   [getProjectedBbox](#getprojectedbbox)
*   [getMapsByGeoBbox](#getmapsbygeobbox)
    *   [Parameters](#parameters-33)
*   [setImageInformations](#setimageinformations)
    *   [Parameters](#parameters-34)
*   [setMapResourceMask](#setmapresourcemask)
    *   [Parameters](#parameters-35)
*   [setMapsTransformationType](#setmapstransformationtype)
    *   [Parameters](#parameters-36)
*   [setMapsDistortionMeasure](#setmapsdistortionmeasure)
    *   [Parameters](#parameters-37)
*   [bringMapsToFront](#bringmapstofront)
    *   [Parameters](#parameters-38)
*   [sendMapsToBack](#sendmapstoback)
    *   [Parameters](#parameters-39)
*   [bringMapsForward](#bringmapsforward)
    *   [Parameters](#parameters-40)
*   [sendMapsBackward](#sendmapsbackward)
    *   [Parameters](#parameters-41)
*   [showMaps](#showmaps)
    *   [Parameters](#parameters-42)
*   [hideMaps](#hidemaps)
    *   [Parameters](#parameters-43)
*   [addGeoreferencedMap](#addgeoreferencedmap)
    *   [Parameters](#parameters-44)
*   [removeGeoreferencedMap](#removegeoreferencedmap)
    *   [Parameters](#parameters-45)
*   [addGeoreferenceAnnotation](#addgeoreferenceannotation)
    *   [Parameters](#parameters-46)
*   [removeGeoreferenceAnnotation](#removegeoreferenceannotation)
    *   [Parameters](#parameters-47)
*   [constructor](#constructor-5)
    *   [Parameters](#parameters-48)
*   [isCachedTile](#iscachedtile)
*   [abort](#abort)
*   [constructor](#constructor-6)
    *   [Parameters](#parameters-49)
*   [fetch](#fetch)
*   [fetch](#fetch-1)
*   [fetch](#fetch-2)
*   [getCacheableTile](#getcacheabletile)
    *   [Parameters](#parameters-50)
*   [getCachedTile](#getcachedtile)
    *   [Parameters](#parameters-51)
*   [getCacheableTiles](#getcacheabletiles)
*   [getCachedTiles](#getcachedtiles)
*   [getTileUrls](#gettileurls)
*   [requestFetchableMapTiles](#requestfetchablemaptiles)
    *   [Parameters](#parameters-52)
*   [constructor](#constructor-7)
    *   [Parameters](#parameters-53)
*   [getOpacity](#getopacity)
*   [setOpacity](#setopacity)
    *   [Parameters](#parameters-54)
*   [resetOpacity](#resetopacity)
*   [getMapOpacity](#getmapopacity)
    *   [Parameters](#parameters-55)
*   [setMapOpacity](#setmapopacity)
    *   [Parameters](#parameters-56)
*   [resetMapOpacity](#resetmapopacity)
    *   [Parameters](#parameters-57)
*   [getRemoveColorOptions](#getremovecoloroptions)
*   [setRemoveColorOptions](#setremovecoloroptions)
    *   [Parameters](#parameters-58)
*   [resetRemoveColorOptions](#resetremovecoloroptions)
*   [getMapRemoveColorOptions](#getmapremovecoloroptions)
    *   [Parameters](#parameters-59)
*   [setMapRemoveColorOptions](#setmapremovecoloroptions)
    *   [Parameters](#parameters-60)
*   [resetMapRemoveColorOptions](#resetmapremovecoloroptions)
    *   [Parameters](#parameters-61)
*   [getColorizeOptions](#getcolorizeoptions)
*   [setColorizeOptions](#setcolorizeoptions)
    *   [Parameters](#parameters-62)
*   [resetColorizeOptions](#resetcolorizeoptions)
*   [getMapColorizeOptions](#getmapcolorizeoptions)
    *   [Parameters](#parameters-63)
*   [setMapColorizeOptions](#setmapcolorizeoptions)
    *   [Parameters](#parameters-64)
*   [resetMapColorizeOptions](#resetmapcolorizeoptions)
    *   [Parameters](#parameters-65)
*   [getGridOptions](#getgridoptions)
*   [setGridOptions](#setgridoptions)
    *   [Parameters](#parameters-66)
*   [resetGridOptions](#resetgridoptions)
*   [getMapGridOptions](#getmapgridoptions)
    *   [Parameters](#parameters-67)
*   [setMapGridOptions](#setmapgridoptions)
    *   [Parameters](#parameters-68)
*   [resetMapGridOptions](#resetmapgridoptions)
    *   [Parameters](#parameters-69)
*   [getSaturation](#getsaturation)
*   [setSaturation](#setsaturation)
    *   [Parameters](#parameters-70)
*   [resetSaturation](#resetsaturation)
*   [getMapSaturation](#getmapsaturation)
    *   [Parameters](#parameters-71)
*   [setMapSaturation](#setmapsaturation)
    *   [Parameters](#parameters-72)
*   [resetMapSaturation](#resetmapsaturation)
    *   [Parameters](#parameters-73)
*   [render](#render)
    *   [Parameters](#parameters-74)

### constructor

Creates an instance of Viewport.

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `o` &#x20;
*   `r` &#x20;
*   `s`   (optional, default `1`)
*   `viewportSize` **Size** Size of the viewport in viewport pixels, as \[width, height].
*   `projectedGeoCenter` **Point** Center point of the viewport, in projected coordinates.
*   `projectedGeoPerViewportScale` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Resolution of the viewport, in projection coordinates per viewport pixel.
*   `rotation` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Rotation of the viewport with respect to the project coordinate system.
*   `devicePixelRatio` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** The devicePixelRatio of the viewport. (optional, default `1`)

### computeProjectedGeoRectangle

Returns a rotated rectangle in projected geo coordinates

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `o` &#x20;
*   `r` &#x20;

### fromWarpedMapList

Alternative Viewport constructor, specifying projectedGeo using a WarpedMapList

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `o` &#x20;
*   `r`   (optional, default `"contain"`)
*   `s`   (optional, default `1`)
*   `viewportSize` **Size** Size of the viewport in viewport pixels, as \[width, height].
*   `warpedMapList` **WarpedMapList\<W>** A WarpedMapList.
*   `devicePixelRatio` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)??** The devicePixelRatio of the viewport.
*   `fit` **Fit** Whether the viewport should contain or cover the bbox of the warpedMapList. (optional, default `'contain'`)

Returns **Viewport** A new Viewport object

### fromProjectedGeoBbox

Alternative Viewport constructor, specifying projectedGeo using a projectedGeoBbox

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `o` &#x20;
*   `r`   (optional, default `"contain"`)
*   `viewportSize` **Size** Size of the viewport in viewport pixels, as \[width, height].
*   `projectedGeoBbox` **WarpedMapList\<W>** A projectedGeoBbox.
*   `devicePixelRatio` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)??** The devicePixelRatio of the viewport.
*   `fit` **Fit** Whether the viewport should contain or cover the bbox of the warpedMapList. (optional, default `'contain'`)

Returns **Viewport** A new Viewport object

### constructor

Creates an instance of WarpedMap.

#### Parameters

*   `e` &#x20;
*   `r` &#x20;
*   `s` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `georeferencedMap` **GeoreferencedMap** Georeferende map this warped map is build on
*   `imageInfoCache` **Cache??** Cache of the image info of this image
*   `visible` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Whether the map is visible (optional, default `true`)

### getViewportMask

Get resourceMask in viewport coordinates

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **Ring**&#x20;

### getViewportMaskBbox

Get bbox of resourceMask in viewport coordinates

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **Bbox**&#x20;

### getViewportMaskRectangle

Get resourceMaskRectangle in viewport coordinates

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **Rectangle**&#x20;

### getViewportFullMask

Get resourceFullMask in viewport coordinates

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **Ring**&#x20;

### getViewportFullMaskBbox

Get bbox of rresourceFullMask in viewport coordinates

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **Bbox**&#x20;

### getViewportFullMaskRectangle

Get resourceFullMaskRectangle in viewport coordinates

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **Rectangle**&#x20;

### getResourceToViewportScale

Get scale of the warped map, in resource pixels per viewport pixels.

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**&#x20;

### getResourceToCanvasScale

Get scale of the warped map, in resource pixels per canvas pixels.

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**&#x20;

### getReferenceScale

Get the reference scaling from the forward transformation of the projected Helmert transformer

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**&#x20;

### setResourceViewportRing

Set resourceViewportRing at current viewport

#### Parameters

*   `e` &#x20;
*   `resourceViewportRing` **Ring**&#x20;

### setResourceMask

Update the resourceMask loaded from a georeferenced map to a new mask.

#### Parameters

*   `e` &#x20;
*   `resourceMask` **Ring**&#x20;

### setTransformationType

Update the transformationType loaded from a georeferenced map to a new transformation type.

#### Parameters

*   `e` &#x20;
*   `transformationType` **TransformationType**&#x20;

### setDistortionMeasure

Set the distortionMeasure

#### Parameters

*   `e` &#x20;
*   `distortionMeasure` **DistortionMeasure?** the disortion measure

### setGcps

Update the Ground Controle Points loaded from a georeferenced map to new Ground Controle Points.

#### Parameters

*   `e` &#x20;
*   `gcps` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)\<GCP>**&#x20;

### setBestScaleFactor

Set the bestScaleFactor at the current viewport

#### Parameters

*   `e` &#x20;
*   `scaleFactor` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** scale factor

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**&#x20;

### hasImageInfo

Check if warpedMap has image info

### loadImageInfo

Fetch and parse the image info, and generate the image ID

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)\<void>**&#x20;

### constructor

Creates an instance of WarpedMap.

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `i` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `georeferencedMap` **GeoreferencedMap** Georeferende map this warped map is build on
*   `imageInfoCache` **Cache??** Cache of the image info of this image

### setResourceMask

Update the resourceMask loaded from a georeferenced map to a new mask.

#### Parameters

*   `e` &#x20;
*   `resourceMask` **Ring**&#x20;

### setBestScaleFactor

Set the bestScaleFactor at the current viewport

#### Parameters

*   `e` &#x20;
*   `scaleFactor` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** scale factor

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**&#x20;

### updateTriangulation

Update the triangulation of the resourceMask, at the current bestScaleFactor. Use cache if available.

#### Parameters

*   `e`   (optional, default `!1`)
*   `previousIsNew` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** whether the previous and new triangulation are the same - true by default, false during a transformation transition (optional, default `false`)

### updateProjectedGeoTrianglePoints

Update the (previous and new) points of the triangulated resourceMask, at the current bestScaleFactor, in projectedGeo coordinates. Use cache if available.

#### Parameters

*   `e`   (optional, default `!1`)
*   `previousIsNew` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**  (optional, default `false`)

### updateTrianglePointsDistortion

Update the (previous and new) distortion at the points of the triangulated resourceMask. Use cache if available.

#### Parameters

*   `e`   (optional, default `!1`)
*   `previousIsNew` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**  (optional, default `false`)

### resetTrianglePoints

Reset the previous points of the triangulated resourceMask in projectedGeo coordinates.

### mixTrianglePoints

Mix the previous and new points of the triangulated resourceMask in projectedGeo coordinates

#### Parameters

*   `e` &#x20;
*   `t` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**&#x20;

### constructor

Creates an instance of WebGL2WarpedMap.

#### Parameters

*   `e` &#x20;
*   `i` &#x20;
*   `r` &#x20;
*   `s` &#x20;
*   `a` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `georeferencedMap` **GeoreferencedMap** Georeferende map this warped map is build on
*   `gl` **WebGL2RenderingContext** the WebGL2 rendering context
*   `program` **[WebGLProgram](https://developer.mozilla.org/docs/Web/API/WebGLProgram)** the WebGL2 program
*   `options` **Partial\<WarpedMapOptions>** WarpedMapOptions

### updateVertexBuffers

Update the vertex buffers of this warped map

#### Parameters

*   `e` &#x20;
*   `projectedGeoToClipTransform` **Transform** Transform from projected geo coordinates to webgl2 coordinates in the \[-1, 1] range. Equivalent to OpenLayer projectionTransform.

### addCachedTileAndUpdateTextures

Add cached tile to the textures of this map and update textures

#### Parameters

*   `e` &#x20;
*   `cachedTile` **CachedTile**&#x20;

### removeCachedTileAndUpdateTextures

Remove cached tile from the textures of this map and update textes

#### Parameters

*   `e` &#x20;
*   `tileUrl` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)**&#x20;

### constructor

Creates an instance of WarpedMapList.

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `imageInfoCache` **Cache??** An image info cache
*   `options` **WarpedMapListOptions??** Options

### getMapIds

Returns mapIds for the maps in this list.

Returns **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### getWarpedMap

Returns the WarpedMap object in this list of map specified by a mapId.

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)**&#x20;

Returns **(W | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### getMapZIndex

Returns the zIndex of a map.

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)**&#x20;

Returns **([number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number) | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### getBbox

Return the bounding box of all visible maps in this list, in longitude/latitude coordinates

Returns **(Bbox | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### getProjectedBbox

Return the bounding box of all visible maps in this list, in projected coordinates

Returns **(Bbox | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### getMapsByGeoBbox

Returns mapIds of the maps whose geoBbox overlaps with the specified geoBbox.

#### Parameters

*   `e` &#x20;
*   `geoBbox` **Bbox**&#x20;

Returns **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### setImageInformations

Sets the image info cache

#### Parameters

*   `e` &#x20;
*   `cache` **Cache** the image info cache

### setMapResourceMask

Sets the resource mask for a specified map

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `resourceMask` **Ring** the new resource mask

### setMapsTransformationType

Sets the transformation type of specified maps

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** the IDs of the maps
*   `transformationType` **TransformationType** the new transformation type

### setMapsDistortionMeasure

Sets the distortion measure of specified maps

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>** the IDs of the maps
*   `distortionMeasure` **DistortionMeasure?** the distortion measure

### bringMapsToFront

Changes the zIndex of the specified maps to bring them to front

#### Parameters

*   `e` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### sendMapsToBack

Changes the zIndex of the specified maps to send them to back

#### Parameters

*   `e` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### bringMapsForward

Changes the zIndex of the specified maps to bring them forward

#### Parameters

*   `e` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### sendMapsBackward

Changes the zIndex of the specified maps to send them backward

#### Parameters

*   `e` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### showMaps

Changes the visibility of the specified maps to `true`

#### Parameters

*   `e` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### hideMaps

Changes the visibility of the specified maps to `false`

#### Parameters

*   `e` &#x20;
*   `mapIds` **Iterable<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### addGeoreferencedMap

Adds a georeferenced map to this list

#### Parameters

*   `e` &#x20;
*   `georeferencedMap` **unknown**&#x20;

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) | [Error](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error))>**&#x20;

### removeGeoreferencedMap

Removes a georeferenced map from this list

#### Parameters

*   `e` &#x20;
*   `georeferencedMap` **unknown**&#x20;

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) | [Error](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error))>**&#x20;

### addGeoreferenceAnnotation

Parses an annotation and adds its georeferenced map to this list

#### Parameters

*   `e` &#x20;
*   `annotation` **unknown**&#x20;

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) | [Error](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error))>>**&#x20;

### removeGeoreferenceAnnotation

Parses an annotation and removes its georeferenced map from this list

#### Parameters

*   `e` &#x20;
*   `annotation` **unknown**&#x20;

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)<[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)<([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) | [Error](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Error))>>**&#x20;

### constructor

Creates an instance of CacheableTile.

#### Parameters

*   `t` &#x20;
*   `e` &#x20;
*   `fetchableMapTile` **FetchableMapTile**&#x20;

### isCachedTile

Whether a tile has completed its caching
I.e. their fetching is completed and tile data is created

Returns **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)**&#x20;

### abort

Abort the fetch

### constructor

Creates an instance of FetchableMapTile.

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `tile` **Tile** the tile
*   `warpedMap` **WarpedMapWithImageInfo** the warpedMap, which must have its image info so the tileUrl can be assigned

### fetch

Fetch the tile and create its image bitmap.

Returns and event when completed (or error).

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)\<void>**&#x20;

### fetch

Fetch the tile and create its image bitmap.

Returns and event when completed (or error).

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)\<void>**&#x20;

### fetch

Fetch the tile and create its image bitmap.

Returns and event when completed (or error).

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)\<void>**&#x20;

### getCacheableTile

Get a specific cacheable tile in this cache
I.e. independent of whether their fetching is completed and image bitmap is created

#### Parameters

*   `e` &#x20;
*   `tileUrl` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the url of the requested tile

Returns **(CacheableTile | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### getCachedTile

Get a specific cached tile in this cache
I.e. with their fetching completed and image bitmap created

#### Parameters

*   `e` &#x20;
*   `tileUrl` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the url of the requested tile

Returns **(CachedTile | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### getCacheableTiles

Get the tiles in this cache (independent of whether their caching has completed)

Returns **IterableIterator\<CacheableTile>**&#x20;

### getCachedTiles

Get the tiles in this cache whose caching has completed

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)\<CacheableTile>**&#x20;

### getTileUrls

Get the URLs of all tiles in this cache

Returns **IterableIterator<[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)>**&#x20;

### requestFetchableMapTiles

Process the request for new tiles to be added to this cache

#### Parameters

*   `e` &#x20;
*   `requestedTiles` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)\<FetchableMapTile>**&#x20;

### constructor

Creates an instance of WebGL2Renderer.

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `gl` **WebGL2RenderingContext** the WebGL2 rendering context
*   `options` **WebGL2RendererOptions** the WebGL2 rendering options

### getOpacity

Get the opacity of the renderer

Returns **([number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number) | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setOpacity

Set the opacity of the renderer

#### Parameters

*   `e` &#x20;
*   `opacity` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** opacity to set

### resetOpacity

Reset the opacity of the renderer

### getMapOpacity

Get the opacity of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

Returns **([number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number) | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setMapOpacity

Set the opacity of a map

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `opacity` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** opacity to set

### resetMapOpacity

Rreset the opacity of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

### getRemoveColorOptions

Get the remove color options of the renderer

Returns **(Partial\<RemoveColorOptions> | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setRemoveColorOptions

Set the remove color options of the renderer

#### Parameters

*   `e` &#x20;
*   `removeColorOptions` **RemoveColorOptions**&#x20;

### resetRemoveColorOptions

Reset the remove color options of the renderer

### getMapRemoveColorOptions

Get the remove color options of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

Returns **(Partial\<RemoveColorOptions> | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setMapRemoveColorOptions

Set the remove color options of a map

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `removeColorOptions` **RemoveColorOptions** the 'remove color options' to set

### resetMapRemoveColorOptions

Reset the remove color options of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

### getColorizeOptions

Get the colorize options of the renderer

Returns **(Partial\<ColorizeOptions> | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setColorizeOptions

Set the colorize options of the renderer

#### Parameters

*   `e` &#x20;
*   `colorizeOptions` **ColorizeOptions** the colorize options to set

### resetColorizeOptions

Reset the colorize options of the renderer

### getMapColorizeOptions

Get the colorize options of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

Returns **(Partial\<ColorizeOptions> | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setMapColorizeOptions

Set the colorize options of a map

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `colorizeOptions` **ColorizeOptions** the colorize options to set

### resetMapColorizeOptions

Reset the colorize options of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

### getGridOptions

Get the grid options of the renderer

Returns **(Partial\<GridOptions> | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setGridOptions

Set the grid options of the renderer

#### Parameters

*   `e` &#x20;
*   `gridOptions` **GridOptions** the grid options to set

### resetGridOptions

Reset the grid options of the renderer

### getMapGridOptions

Get the grid options of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

Returns **(Partial\<GridOptions> | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setMapGridOptions

Set the grid options of a map

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map
*   `gridOptions` **GridOptions** the grid options to set

### resetMapGridOptions

Reset the grid options of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

### getSaturation

Get the saturation of the renderer

Returns **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**&#x20;

### setSaturation

Set the saturation of the renderer

0 - grayscale, 1 - original colors

#### Parameters

*   `e` &#x20;
*   `saturation`  the satuation to set

### resetSaturation

Reset the satuation of the renderer

### getMapSaturation

Get the saturation of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

Returns **([number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number) | [undefined](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/undefined))**&#x20;

### setMapSaturation

Set the saturation of a map

0 - grayscale, 1 - original colors

#### Parameters

*   `e` &#x20;
*   `t` &#x20;
*   `mapId`  ID of the map
*   `saturation`  the saturation to set

### resetMapSaturation

Reset the saturation of a map

#### Parameters

*   `e` &#x20;
*   `mapId` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** ID of the map

### render

Render the map for a given viewport

#### Parameters

*   `e` &#x20;
*   `viewport` **Viewport** the current viewport
